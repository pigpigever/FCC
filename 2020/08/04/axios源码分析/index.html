
<!DOCTYPE html>
<html lang="en" class="loading">
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>æ·±å…¥ç†è§£ axios - Tonychen</title>
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="google" content="notranslate" />
    <meta name="keywords" content="Fechin,"> 
    <meta name="description" content="axios æ˜¯ä»€ä¹ˆ
axios æ˜¯åŸºäº Promise å¹¶ç”¨äºæµè§ˆå™¨å’Œ node.js çš„ HTTP è¯·æ±‚åº“ã€‚
axios çš„å¸¸è§åŠŸèƒ½
æ”¯æŒè¯·æ±‚ã€å“åº”æ‹¦æˆª
123456789101112131415,"> 
    <meta name="author" content="Tonychen"> 
    <link rel="alternative" href="atom.xml" title="Tonychen" type="application/atom+xml"> 
    <link rel="icon" href="/img/favicon.png"> 
    
    
<link rel="stylesheet" href="/css/diaspora.css">

	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
         (adsbygoogle = window.adsbygoogle || []).push({
              google_ad_client: "ca-pub-8691406134231910",
              enable_page_level_ads: true
         });
    </script>
    <script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
<meta name="generator" content="Hexo 4.2.1"></head>

<body class="loading">
    <span id="config-title" style="display:none">Tonychen</span>
    <div id="loader"></div>
    <div id="single">
    <div id="top" style="display: block;">
    <div class="bar" style="width: 0;"></div>
    <a class="iconfont icon-home image-icon" href="javascript:;" data-url="https://pigpigever.github.io"></a>
    <div title="æ’­æ”¾/æš‚åœ" class="iconfont icon-play"></div>
    <h3 class="subtitle">æ·±å…¥ç†è§£ axios</h3>
    <div class="social">
        <div>
            <div class="share">
                <a title="è·å–äºŒç»´ç " class="iconfont icon-scan" href="javascript:;"></a>
            </div>
            <div id="qr"></div>
        </div>
    </div>
    <div class="scrollbar"></div>
</div>

    <div class="section">
        <div class="article">
    <div class='main'>
        <h1 class="title">æ·±å…¥ç†è§£ axios</h1>
        <div class="stuff">
            <span>å…«æœˆ 04, 2020</span>
            
  <ul class="post-tags-list" itemprop="keywords"><li class="post-tags-list-item"><a class="post-tags-list-link" href="/tags/%E6%BA%90%E7%A0%81/" rel="tag">æºç </a></li><li class="post-tags-list-item"><a class="post-tags-list-link" href="/tags/%E9%98%85%E8%AF%BB/" rel="tag">é˜…è¯»</a></li></ul>


        </div>
        <div class="content markdown">
            <h2 id="axios-æ˜¯ä»€ä¹ˆ">axios æ˜¯ä»€ä¹ˆ<a title="#axios-æ˜¯ä»€ä¹ˆ" href="#axios-æ˜¯ä»€ä¹ˆ"></a></h2>
<p><code>axios</code> æ˜¯åŸºäº <code>Promise</code> å¹¶ç”¨äºæµè§ˆå™¨å’Œ <code>node.js</code> çš„ <code>HTTP</code> è¯·æ±‚åº“ã€‚</p>
<h2 id="axios-çš„å¸¸è§åŠŸèƒ½">axios çš„å¸¸è§åŠŸèƒ½<a title="#axios-çš„å¸¸è§åŠŸèƒ½" href="#axios-çš„å¸¸è§åŠŸèƒ½"></a></h2>
<h3 id="æ”¯æŒè¯·æ±‚ã€å“åº”æ‹¦æˆª">æ”¯æŒè¯·æ±‚ã€å“åº”æ‹¦æˆª<a title="#æ”¯æŒè¯·æ±‚ã€å“åº”æ‹¦æˆª" href="#æ”¯æŒè¯·æ±‚ã€å“åº”æ‹¦æˆª"></a></h3>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Add a request interceptor</span></span><br><span class="line">axios.interceptors.request.use(<span class="function"><span class="keyword">function</span> (<span class="params">config</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// Do something before request is sent</span></span><br><span class="line">    <span class="keyword">return</span> config;</span><br><span class="line">  &#125;, <span class="function"><span class="keyword">function</span> (<span class="params">error</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// Do something with request error</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(error);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Add a response interceptor</span></span><br><span class="line">axios.interceptors.response.use(<span class="function"><span class="keyword">function</span> (<span class="params">response</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// Any status code that lie within the range of 2xx cause this function to trigger</span></span><br><span class="line">    <span class="comment">// Do something with response data</span></span><br><span class="line">    <span class="keyword">return</span> response;</span><br><span class="line">  &#125;, <span class="function"><span class="keyword">function</span> (<span class="params">error</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// Any status codes that falls outside the range of 2xx cause this function to trigger</span></span><br><span class="line">    <span class="comment">// Do something with response error</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(error);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure>
<h3 id="å–æ¶ˆè¯·æ±‚">å–æ¶ˆè¯·æ±‚<a title="#å–æ¶ˆè¯·æ±‚" href="#å–æ¶ˆè¯·æ±‚"></a></h3>
<ol>
<li>é€šè¿‡ <code>CancelToken.source</code> è¿™ä¸ªå·¥å‚å‡½æ•°æ¥è·å– <code>cancel</code> å‡½æ•°ã€‚</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> CancelToken = axios.CancelToken;</span><br><span class="line"><span class="keyword">const</span> source = CancelToken.source();</span><br><span class="line"></span><br><span class="line">axios.get(<span class="string">'/user/12345'</span>, &#123;</span><br><span class="line">  cancelToken: source.token</span><br><span class="line">&#125;).catch(<span class="function"><span class="keyword">function</span> (<span class="params">thrown</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (axios.isCancel(thrown)) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'Request canceled'</span>, thrown.message);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// handle error</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">axios.post(<span class="string">'/user/12345'</span>, &#123;</span><br><span class="line">  name: <span class="string">'new name'</span></span><br><span class="line">&#125;, &#123;</span><br><span class="line">  cancelToken: source.token</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// cancel the request (the message parameter is optional)</span></span><br><span class="line">source.cancel(<span class="string">'Operation canceled by the user.'</span>);</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>é€šè¿‡ <code>CancelToken</code> çš„æ„é€ å‡½æ•°æ¥è·å– <code>cancel</code> å‡½æ•°ã€‚</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> CancelToken = axios.CancelToken;</span><br><span class="line"><span class="keyword">let</span> cancel;</span><br><span class="line"></span><br><span class="line">axios.get(<span class="string">'/user/12345'</span>, &#123;</span><br><span class="line">  cancelToken: <span class="keyword">new</span> CancelToken(<span class="function"><span class="keyword">function</span> <span class="title">executor</span>(<span class="params">c</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// An executor function receives a cancel function as a parameter</span></span><br><span class="line">    cancel = c;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// cancel the request</span></span><br><span class="line">cancel();</span><br></pre></td></tr></table></figure>
<h3 id="é¢„é˜²-xsrf">é¢„é˜² <code>XSRF</code><a title="#é¢„é˜²-xsrf" href="#é¢„é˜²-xsrf"></a></h3>
<p>å¯ä»¥é€šè¿‡è®¾ç½® <code>XSRF token</code> æ¥é¢„é˜² <code>XSRF/CSRF</code>ã€‚</p>
<ul>
<li>æ”¯æŒ <code>Promise API</code></li>
<li>è·å–ä¸Šä¼ ã€ä¸‹è½½è¿›åº¦</li>
</ul>
<h2 id="æºç åˆ†æ">æºç åˆ†æ<a title="#æºç åˆ†æ" href="#æºç åˆ†æ"></a></h2>
<h3 id="ç›®å½•">ç›®å½•<a title="#ç›®å½•" href="#ç›®å½•"></a></h3>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">â”œâ”€â”€ adapters</span><br><span class="line">â”‚   â”œâ”€â”€ README.md</span><br><span class="line">â”‚   â”œâ”€â”€ http.js</span><br><span class="line">â”‚   â””â”€â”€ xhr.js</span><br><span class="line">â”œâ”€â”€ axios.js</span><br><span class="line">â”œâ”€â”€ cancel</span><br><span class="line">â”‚   â”œâ”€â”€ Cancel.js</span><br><span class="line">â”‚   â”œâ”€â”€ CancelToken.js</span><br><span class="line">â”‚   â””â”€â”€ isCancel.js</span><br><span class="line">â”œâ”€â”€ core</span><br><span class="line">â”‚   â”œâ”€â”€ Axios.js</span><br><span class="line">â”‚   â”œâ”€â”€ InterceptorManager.js</span><br><span class="line">â”‚   â”œâ”€â”€ README.md</span><br><span class="line">â”‚   â”œâ”€â”€ buildFullPath.js</span><br><span class="line">â”‚   â”œâ”€â”€ createError.js</span><br><span class="line">â”‚   â”œâ”€â”€ dispatchRequest.js</span><br><span class="line">â”‚   â”œâ”€â”€ enhanceError.js</span><br><span class="line">â”‚   â”œâ”€â”€ mergeConfig.js</span><br><span class="line">â”‚   â”œâ”€â”€ settle.js</span><br><span class="line">â”‚   â””â”€â”€ transformData.js</span><br><span class="line">â”œâ”€â”€ defaults.js</span><br><span class="line">â”œâ”€â”€ helpers</span><br><span class="line">â”‚   â”œâ”€â”€ README.md</span><br><span class="line">â”‚   â”œâ”€â”€ bind.js</span><br><span class="line">â”‚   â”œâ”€â”€ buildURL.js</span><br><span class="line">â”‚   â”œâ”€â”€ combineURLs.js</span><br><span class="line">â”‚   â”œâ”€â”€ cookies.js</span><br><span class="line">â”‚   â”œâ”€â”€ deprecatedMethod.js</span><br><span class="line">â”‚   â”œâ”€â”€ isAbsoluteURL.js</span><br><span class="line">â”‚   â”œâ”€â”€ isURLSameOrigin.js</span><br><span class="line">â”‚   â”œâ”€â”€ normalizeHeaderName.js</span><br><span class="line">â”‚   â”œâ”€â”€ parseHeaders.js</span><br><span class="line">â”‚   â””â”€â”€ spread.js</span><br><span class="line">â””â”€â”€ utils.js</span><br></pre></td></tr></table></figure>
<h3 id="æ ¸å¿ƒåŠŸèƒ½">æ ¸å¿ƒåŠŸèƒ½<a title="#æ ¸å¿ƒåŠŸèƒ½" href="#æ ¸å¿ƒåŠŸèƒ½"></a></h3>
<h4 id="axios-æ„é€ å‡½æ•°">Axios æ„é€ å‡½æ•°<a title="#axios-æ„é€ å‡½æ•°" href="#axios-æ„é€ å‡½æ•°"></a></h4>
<p>ä¸€èˆ¬æ¥è¯´ï¼Œæ„é€ å‡½æ•°èµ·åˆ°ä¸€ä¸ªåˆå§‹åŒ–å†…éƒ¨å¯¹è±¡çš„ä½œç”¨ï¼Œå½“ç„¶ <code>axios</code> ä¹Ÿä¸ä¾‹å¤–ğŸ‘‡</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Create a new instance of Axios</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;Object&#125;</span> </span>instanceConfig The default config for the instance</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Axios</span>(<span class="params">instanceConfig</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.defaults = instanceConfig;</span><br><span class="line">  <span class="keyword">this</span>.interceptors = &#123;</span><br><span class="line">    request: <span class="keyword">new</span> InterceptorManager(),</span><br><span class="line">    response: <span class="keyword">new</span> InterceptorManager()</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="axios.prototype.request">Axios.prototype.request<a title="#axios.prototype.request" href="#axios.prototype.request"></a></h4>
<p>è¿™ä¸ªå‡½æ•°ä¸€å…±åšäº†è¿™äº›äº‹æƒ…ï¼š</p>
<ol>
<li>åˆå¹¶é…ç½®</li>
<li>è®¾ç½®è¯·æ±‚æ–¹æ³•ï¼ˆä¹Ÿå¯ä»¥å½’åˆ°ä¸Šä¸€æ­¥ï¼‰</li>
<li>ç»‘å®šæ‹¦æˆªå™¨å¹¶ç”Ÿæˆ <code>promise</code> é˜Ÿåˆ—</li>
<li>æ‰§è¡Œ <code>promise</code> é˜Ÿåˆ—</li>
<li>è¿”å›æ‰§è¡Œç»“æœ</li>
</ol>
<p>å¯ä»¥è¯´ï¼Œç†è§£äº†è¿™æ®µæè¿°ï¼Œå°±èƒ½ç†æ¸… <code>axios</code> å¤§è‡´çš„æµç¨‹äº†ã€‚ä¸‹é¢æ˜¯å…·ä½“çš„ä»£ç ğŸ‘‡</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Dispatch a request</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;Object&#125;</span> </span>config The config specific for this request (merged with this.defaults)</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">Axios.prototype.request = <span class="function"><span class="keyword">function</span> <span class="title">request</span>(<span class="params">config</span>) </span>&#123;</span><br><span class="line">  <span class="comment">/*eslint no-param-reassign:0*/</span></span><br><span class="line">  <span class="comment">// Allow for axios('example/url'[, config]) a la fetch API</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> config === <span class="string">'string'</span>) &#123;</span><br><span class="line">    config = <span class="built_in">arguments</span>[<span class="number">1</span>] || &#123;&#125;;</span><br><span class="line">    config.url = <span class="built_in">arguments</span>[<span class="number">0</span>];</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    config = config || &#123;&#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  config = mergeConfig(<span class="keyword">this</span>.defaults, config);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Set config.method</span></span><br><span class="line">  <span class="keyword">if</span> (config.method) &#123;</span><br><span class="line">    config.method = config.method.toLowerCase();</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">this</span>.defaults.method) &#123;</span><br><span class="line">    config.method = <span class="keyword">this</span>.defaults.method.toLowerCase();</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    config.method = <span class="string">'get'</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Hook up interceptors middleware</span></span><br><span class="line">  <span class="keyword">var</span> chain = [dispatchRequest, <span class="literal">undefined</span>];</span><br><span class="line">  <span class="keyword">var</span> promise = <span class="built_in">Promise</span>.resolve(config);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">this</span>.interceptors.request.forEach(<span class="function"><span class="keyword">function</span> <span class="title">unshiftRequestInterceptors</span>(<span class="params">interceptor</span>) </span>&#123;</span><br><span class="line">    chain.unshift(interceptor.fulfilled, interceptor.rejected);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">this</span>.interceptors.response.forEach(<span class="function"><span class="keyword">function</span> <span class="title">pushResponseInterceptors</span>(<span class="params">interceptor</span>) </span>&#123;</span><br><span class="line">    chain.push(interceptor.fulfilled, interceptor.rejected);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">while</span> (chain.length) &#123;</span><br><span class="line">    promise = promise.then(chain.shift(), chain.shift());</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> promise;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹å‡ºï¼Œã€Œæ‹¦æˆªå™¨ã€è¿™ä¸ªåŠŸèƒ½ï¼Œæ— éæ˜¯å°†ã€Œæ‹¦æˆªå™¨ã€å’Œå®é™…çš„è¯·æ±‚æ‹¼æˆä¸€ä¸ªé˜Ÿåˆ—ï¼Œæœ€å <code>axios</code> æŠ›å‡ºçš„ <code>promise</code> å¯¹è±¡å…¶å®å°±æ˜¯<br>
é˜Ÿåˆ—ä¸­æœ€åä¸€ä¸ªä»»åŠ¡æ‰§è¡Œä¹‹åè¿”å›çš„ç»“æœã€‚</p>
<p><img src="/images/axios/axios.jpg" alt="" class="Ï†cx"></p>
<h5 id="dispatchrequest">dispatchRequest<a title="#dispatchrequest" href="#dispatchrequest"></a></h5>
<p>å¯ä»¥çœ‹å‡º <code>dispatchRequest</code> åœ¨ <code>Axios.prototype.request</code> ä¸­è¢«æ”¾å…¥åˆ° <code>promise</code> é˜Ÿåˆ—ä¸­æ‰§è¡Œï¼Œå…¶å®å®ƒå°±æ˜¯å®é™…å‘èµ·è¯·æ±‚çš„å‡½æ•°ã€‚<br>
è¿™ä¸ªæ–¹æ³•çš„å®ç°å¯ä»¥åˆ†å‡ ä¸ªæ­¥éª¤æ¥çœ‹ï¼š</p>
<ol>
<li>è®¾ç½®ã€åˆå¹¶è¯·æ±‚å¤´</li>
<li>æ¸…é™¤ <code>headers</code> é‡Œçš„æ— ç”¨å±æ€§</li>
<li>è°ƒç”¨ <code>adapter</code> æ–¹æ³•å‘èµ·è¯·æ±‚</li>
</ol>
<h5 id="adapter">adapter<a title="#adapter" href="#adapter"></a></h5>
<h4 id="interceptormanager">InterceptorManager<a title="#interceptormanager" href="#interceptormanager"></a></h4>
<p><code>Axios</code> å°è£…äº† <code>InterceptorManager</code>ï¼Œç”¨æ¥ç®¡ç†æ³¨å†Œçš„æ‹¦æˆªå™¨ã€‚</p>
<h5 id="æ„é€ å‡½æ•°">æ„é€ å‡½æ•°<a title="#æ„é€ å‡½æ•°" href="#æ„é€ å‡½æ•°"></a></h5>
<p>æ„é€ å‡½æ•°é‡Œåªå£°æ˜äº†ä¸€ä¸ªæ•°ç»„ <code>handlers</code>ï¼Œç”¨æ¥ä¿å­˜æ‹¦æˆªå™¨çš„å›è°ƒã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">InterceptorManager</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.handlers = [];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="interceptormanager.prototype.use">InterceptorManager.prototype.use<a title="#interceptormanager.prototype.use" href="#interceptormanager.prototype.use"></a></h5>
<p><code>InterceptorManager.prototype.use</code> ä¸»è¦å°†æ‹¦æˆªå™¨å­˜å…¥ <code>handlers</code>ï¼Œè°ƒç”¨ä¹‹åè¿”å› <code>this.handler.length - 1</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">InterceptorManager.prototype.use = <span class="function"><span class="keyword">function</span> <span class="title">use</span>(<span class="params">fulfilled, rejected</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.handlers.push(&#123;</span><br><span class="line">    fulfilled: fulfilled,</span><br><span class="line">    rejected: rejected</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.handlers.length - <span class="number">1</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h5 id="interceptormanager.prototype.eject">InterceptorManager.prototype.eject<a title="#interceptormanager.prototype.eject" href="#interceptormanager.prototype.eject"></a></h5>
<p><code>InterceptorManager.prototype.eject</code> ä¸»è¦å°†æŒ‡å®šçš„æ‹¦æˆªå™¨ä» <code>handlers</code> ä¸­ç§»é™¤ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">InterceptorManager.prototype.eject = <span class="function"><span class="keyword">function</span> <span class="title">eject</span>(<span class="params">id</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">this</span>.handlers[id]) &#123;</span><br><span class="line">    <span class="keyword">this</span>.handlers[id] = <span class="literal">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h5 id="interceptormanager.prototype.foreach">InterceptorManager.prototype.forEach<a title="#interceptormanager.prototype.foreach" href="#interceptormanager.prototype.foreach"></a></h5>
<p><code>InterceptorManager.prototype.forEach</code> éœ€è¦ä¼ å…¥ä¸€ä¸ªå‚æ•° <code>fn</code>ï¼Œä¹‹åä¼šéå† <code>handlers</code> å¹¶ä»¥ <code>handlers</code> ä¸­çš„æ‹¦æˆªå™¨ <code>h</code> ä¸ºå‚æ•°ï¼ŒæŒ¨ä¸ªæ‰§è¡Œ <code>fn(h)</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">InterceptorManager.prototype.forEach = <span class="function"><span class="keyword">function</span> <span class="title">forEach</span>(<span class="params">fn</span>) </span>&#123;</span><br><span class="line">  utils.forEach(<span class="keyword">this</span>.handlers, <span class="function"><span class="keyword">function</span> <span class="title">forEachHandler</span>(<span class="params">h</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (h !== <span class="literal">null</span>) &#123;</span><br><span class="line">      fn(h);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h5 id="å°ç»“">å°ç»“<a title="#å°ç»“" href="#å°ç»“"></a></h5>
<p><img src="/images/axios/InterceptorManage.png" alt="" class="Ï†cx"></p>
<h4 id="canceltoken">CancelToken<a title="#canceltoken" href="#canceltoken"></a></h4>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * A `CancelToken` is an object that can be used to request cancellation of an operation.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@class</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;Function&#125;</span> </span>executor The executor function.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">CancelToken</span>(<span class="params">executor</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> executor !== <span class="string">'function'</span>) &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="string">'executor must be a function.'</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> resolvePromise;</span><br><span class="line">  <span class="keyword">this</span>.promise = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> <span class="title">promiseExecutor</span>(<span class="params">resolve</span>) </span>&#123;</span><br><span class="line">    resolvePromise = resolve;</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> token = <span class="keyword">this</span>;</span><br><span class="line">  executor(<span class="function"><span class="keyword">function</span> <span class="title">cancel</span>(<span class="params">message</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (token.reason) &#123;</span><br><span class="line">      <span class="comment">// Cancellation has already been requested</span></span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    token.reason = <span class="keyword">new</span> Cancel(message);</span><br><span class="line">    resolvePromise(token.reason);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä»£ç å¹¶ä¸éš¾æ‡‚ï¼Œä¸»è¦å®ç°è¿™äº›åŠŸèƒ½ï¼š</p>
<ul>
<li>æ‰§è¡Œä¼ å…¥ <code>CancelToken</code> çš„å‚æ•° <code>executor</code></li>
<li>æŒ‚è½½ä¸€ä¸ª <code>promise</code> å¹¶åœ¨ <code>executor</code> æ‰§è¡Œä¹‹å <code>resolvePromise</code>ï¼Œæ¢å¥è¯è¯´ï¼Œå¯ä»¥é€šè¿‡ <code>this.promise</code> æ¥è·å– <code>executor</code> çš„æ‰§è¡Œç»“æœã€‚</li>
</ul>
<p>ä¸è¿‡ï¼Œçœ¼å°–çš„åŒå­¦å¯ä»¥çœ‹åˆ°ä»£ç ä¸­å‡ºç°äº† <code>Cancel</code> è¿™ä¸ªæ„é€ å‡½æ•°ï¼Œå®ƒåˆæœ‰ä»€ä¹ˆä½œç”¨å‘¢ï¼Ÿ</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * A `Cancel` is an object that is thrown when an operation is canceled.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@class</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;string=&#125;</span> </span>message The message.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Cancel</span>(<span class="params">message</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.message = message;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Cancel.prototype.toString = <span class="function"><span class="keyword">function</span> <span class="title">toString</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">'Cancel'</span> + (<span class="keyword">this</span>.message ? <span class="string">': '</span> + <span class="keyword">this</span>.message : <span class="string">''</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Cancel.prototype.__CANCEL__ = <span class="literal">true</span>;</span><br></pre></td></tr></table></figure>
<p>OKï¼Œå…¶å® <code>Cancel</code> ä¸è¿‡æ˜¯ç”¨æ¥å­˜æ”¾ <code>message</code>ï¼Œå®ƒå°±æ˜¯ä¸ªã€Œå·¥å…·äººã€ğŸ¶</p>
<h5 id="canceltoken.source">CancelToken.source<a title="#canceltoken.source" href="#canceltoken.source"></a></h5>
<p>å½“ç„¶ï¼Œ<code>axios</code> è¿˜æä¾›äº†å¦å¤–ä¸€ä¸ªæ–¹æ³•ã€‚å¯ä»¥çœ‹åˆ° <code>CancelToken</code> ä¸ŠæŒ‚è½½äº†ä¸€ä¸ª <code>source</code> å‡½æ•°ï¼ŒåŒæ ·å®ƒä¹Ÿå¯ä»¥ç”¨æ¥è·å– <code>token</code> å¹¶å–æ¶ˆè¯·æ±‚ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Returns an object that contains a new `CancelToken` and a function that, when called,</span></span><br><span class="line"><span class="comment"> * cancels the `CancelToken`.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">CancelToken.source = <span class="function"><span class="keyword">function</span> <span class="title">source</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> cancel;</span><br><span class="line">  <span class="keyword">var</span> token = <span class="keyword">new</span> CancelToken(<span class="function"><span class="keyword">function</span> <span class="title">executor</span>(<span class="params">c</span>) </span>&#123;</span><br><span class="line">    cancel = c;</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    token: token,</span><br><span class="line">    cancel: cancel</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h5 id="canceltoken.prototype.throwifrequested">CancelToken.prototype.throwIfRequested<a title="#canceltoken.prototype.throwifrequested" href="#canceltoken.prototype.throwifrequested"></a></h5>
<p>è¯·æ±‚å–æ¶ˆæ—¶ï¼Œå°±å¯ä»¥åˆ©ç”¨ <code>throwIfRequested</code> æ¥æŠ›å‡ºå–æ¶ˆçš„ <code>reason</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Throws a `Cancel` if cancellation has been requested.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">CancelToken.prototype.throwIfRequested = <span class="function"><span class="keyword">function</span> <span class="title">throwIfRequested</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">this</span>.reason) &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">this</span>.reason;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h5 id="å°ç»“-1">å°ç»“<a title="#å°ç»“-1" href="#å°ç»“-1"></a></h5>
<p><img src="/images/axios/cancel.png" alt="" class="Ï†cx"></p>
<h2 id="å‚è€ƒèµ„æ–™">å‚è€ƒèµ„æ–™<a title="#å‚è€ƒèµ„æ–™" href="#å‚è€ƒèµ„æ–™"></a></h2>
<ul>
<li><a href="https://github.com/axios/axios" target="_blank">axios æ–‡æ¡£</a></li>
</ul>

            <!--[if lt IE 9]><script>document.createElement('audio');</script><![endif]-->
            <audio id="audio" loop="1" preload="auto" controls="controls" data-autoplay="false">
                <source type="audio/mpeg" src="">
            </audio>
            
                <ul id="audio-list" style="display:none">
                    
                        
                            <li title='0' data-url='http://link.hhtjim.com/163/425570952.mp3'></li>
                        
                    
                        
                            <li title='1' data-url='http://link.hhtjim.com/163/425570952.mp3'></li>
                        
                    
                </ul>
            
        </div>
        
    <div id='gitalk-container' class="comment link"
		data-enable='false'
        data-ae='false'
        data-ci=''
        data-cs=''
        data-r=''
        data-o=''
        data-a=''
        data-d='false'
    >æŸ¥çœ‹è¯„è®º</div>


    </div>
    
</div>


    </div>
</div>
</body>


<script src="//lib.baomitu.com/jquery/1.8.3/jquery.min.js"></script>
<script src="/js/plugin.js"></script>
<script src="/js/typed.js"></script>
<script src="/js/diaspora.js"></script>


<link rel="stylesheet" href="/photoswipe/photoswipe.css">
<link rel="stylesheet" href="/photoswipe/default-skin/default-skin.css">


<script src="/photoswipe/photoswipe.min.js"></script>
<script src="/photoswipe/photoswipe-ui-default.min.js"></script>


<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>
    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">
        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>
        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">
            <div class="pswp__top-bar">
                <!--  Controls are self-explanatory. Order can be changed. -->
                <div class="pswp__counter"></div>
                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
                <button class="pswp__button pswp__button--share" title="Share"></button>
                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>
            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>
            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>
            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>
            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>
        </div>
    </div>
</div>






</html>
