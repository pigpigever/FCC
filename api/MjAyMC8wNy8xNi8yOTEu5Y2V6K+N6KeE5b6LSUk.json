{"title":"291.单词规律II","date":"2020-07-15T16:48:25.000Z","date_formatted":{"ll":"Jul 16, 2020","L":"07/16/2020","MM-DD":"07-16"},"thumbnail":"/images/thumbnail/1.jpeg","link":"2020/07/16/291.单词规律II","tags":["LeetCode","回溯算法","算法"],"categories":["LeetCode"],"updated":"2020-07-29T12:27:45.133Z","content":"<p><a href=\"https://leetcode-cn.com/problems/word-pattern-ii/\" target=\"_blank\">题目来源</a></p>\n<h2 id=\"题目\">题目<a title=\"#题目\" href=\"#题目\"></a></h2>\n<p>给你一种规律 pattern 和一个字符串 str，请你判断 str 是否遵循其相同的规律。<br>\n这里我们指的是 完全遵循，例如 pattern 里的每个字母和字符串 str 中每个 非空 单词之间，存在着双向连接的对应规律。</p>\n<p>示例1:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">输入: pattern &#x3D; &quot;abab&quot;, str &#x3D; &quot;redblueredblue&quot;</span><br><span class=\"line\">输出: true</span><br></pre></td></tr></table></figure>\n<p>示例2:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">输入: pattern &#x3D; &quot;aaaa&quot;, str &#x3D; &quot;asdasdasdasd&quot;</span><br><span class=\"line\">输出: true</span><br></pre></td></tr></table></figure>\n<p>示例2:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">输入: pattern &#x3D; &quot;aabb&quot;, str &#x3D; &quot;xyzabcxzyabc&quot;</span><br><span class=\"line\">输出: false</span><br></pre></td></tr></table></figure>\n<p>提示：</p>\n<ul>\n<li>你可以默认 pattern 和 str 都只会包含小写字母。</li>\n</ul>\n<h2 id=\"解题思路\">解题思路<a title=\"#解题思路\" href=\"#解题思路\"></a></h2>\n<ul>\n<li>设置两个 <code>map</code> 分别为 <code>forward</code> 和 <code>reverse</code>，用来匹配 <code>a--&gt; b</code> 和 <code>b --&gt; a</code>。</li>\n<li>对于键值 <code>pattern[index]</code> 和 <code>currStr</code>，如果存在 <code>forward.get(pattern[index]) !== currStr ||| reverse.get(currStr) !== pattern[index]</code>，说明跟之前匹配的规律不一样，这个时候跳过即可。</li>\n<li>设置键值对应关系（对于没有之前保存过的值）</li>\n<li>递归环节……</li>\n<li>如果暂时不能判断形成了「单词规律」，那么要把对应的 <code>key</code> 值从 <code>map</code> 中删除。注意如果在上一个递归已经形成了当前 <code>key</code> 的「单词规律」，那么它是不能被删除的，因为删除了之后会影响到下次匹配的情况。</li>\n</ul>\n<h2 id=\"代码\">代码<a title=\"#代码\" href=\"#代码\"></a></h2>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param <span class=\"type\">&#123;string&#125;</span> <span class=\"variable\">pattern</span></span></span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param <span class=\"type\">&#123;string&#125;</span> <span class=\"variable\">str</span></span></span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@return <span class=\"type\">&#123;boolean&#125;</span></span></span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> wordPatternMatch = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">pattern, str</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 判断是否是匹配的单词规律</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param <span class=\"type\">&#123;number&#125;</span> <span class=\"variable\">index</span></span></span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param <span class=\"type\">&#123;string&#125;</span> <span class=\"variable\">str</span></span></span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param <span class=\"type\">&#123;map&#125;</span> <span class=\"variable\">forward</span></span></span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param <span class=\"type\">&#123;map&#125;</span> <span class=\"variable\">reverse</span></span></span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return <span class=\"type\">&#123;boolean&#125;</span></span></span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">const</span> isMatch = <span class=\"function\">(<span class=\"params\">index, str, forward, reverse</span>) =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (index &gt;= pattern.length) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (!str) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"literal\">true</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"literal\">false</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">let</span> i = <span class=\"number\">1</span>; i &lt;= str.length; i++) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 假设之前已经有这段匹配了</span></span><br><span class=\"line\">            <span class=\"comment\">// 那么先暂存之前建立的双向对应关系</span></span><br><span class=\"line\">            <span class=\"keyword\">const</span> currStr = str.slice(<span class=\"number\">0</span>, i)</span><br><span class=\"line\">            <span class=\"keyword\">const</span> prevPattern = forward.get(pattern[index])</span><br><span class=\"line\">            <span class=\"keyword\">const</span> prevStr = reverse.get(currStr)</span><br><span class=\"line\">            <span class=\"comment\">// 如果跟之前存入的值不匹配就跳过</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (forward.has(pattern[index]) &amp;&amp; prevPattern !== currStr) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">continue</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (reverse.has(currStr) &amp;&amp; prevStr !== pattern[index]) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">continue</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"comment\">// 设置新的值</span></span><br><span class=\"line\">            <span class=\"comment\">// 注意这里判断一个即可（因为它们是关联的）</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (!forward.has(pattern[index])) &#123;</span><br><span class=\"line\">                forward.set(pattern[index], currStr)</span><br><span class=\"line\">                reverse.set(currStr, pattern[index])</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (isMatch(index + <span class=\"number\">1</span>, str.slice(i), forward, reverse)) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"literal\">true</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"comment\">// 如果之前的值为空的话现在就可以删</span></span><br><span class=\"line\">            <span class=\"comment\">// 不然涉及到之前的键值匹配问题</span></span><br><span class=\"line\">            <span class=\"comment\">// 删了的话会影响到后面的匹配</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (!prevPattern) &#123;</span><br><span class=\"line\">                forward.delete(pattern[index])</span><br><span class=\"line\">                reverse.delete(currStr)</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">false</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// 如果都为空说明完全匹配</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!pattern &amp;&amp; !str) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">true</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// 如果其中有一个为空了说明不匹配</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!pattern || !str) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">false</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> isMatch(<span class=\"number\">0</span>, str, <span class=\"keyword\">new</span> <span class=\"built_in\">Map</span>(), <span class=\"keyword\">new</span> <span class=\"built_in\">Map</span>())</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n","prev":{"title":"679. 24 点游戏","link":"2020/07/16/679.24点游戏"},"next":{"title":"1219. 黄金矿工","link":"2020/07/14/1219.黄金矿工"},"plink":"https://pigpigever.github.io/2020/07/16/291.单词规律II/","toc":[{"id":"题目","title":"题目","index":"1"},{"id":"解题思路","title":"解题思路","index":"2"},{"id":"代码","title":"代码","index":"3"}]}